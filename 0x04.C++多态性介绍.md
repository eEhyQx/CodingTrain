# 多态

*主讲：张启煊*

- 一个接口，多种方法

- 多态性指相同对象收到不同消息或不同对象收到相同消息时产生不同的实现动作

## Q1：静态多态

* 函数由于参数表在参数数目、类型上的不同所实现的多态

### e.g 

**朱铁饶**　有一套　**续命大法**　可以用来对付　**一个坏人**　或　**两个坏人** 　或　**一条狗**；

朱铁饶在遇到一个坏人的时候会上去打；

朱铁饶在遇到两个坏人的时候会跑；

朱铁饶在遇到一条狗的时候也会跑；

**朱铁饶**　有一套　**续命大法**　可以用来对付　**一个坏人**　{打；}

**朱铁饶**　有一套　**续命大法**　可以用来对付　**两个坏人**　{跑；}

**朱铁饶**　有一套　**续命大法**　可以用来对付　**一条狗**　{跑；}

### 总结

要有明确**特征**让计算机知道你要触发的是哪一套操作；

假如你是朱铁饶，你可以有以下途径知道该怎么做：

* 来的对象是人还是狗
* 来的对象是几个人

相比于C++，编译器可以 通过以下特征知道你要运行怎么样的运算：

* 你的参数表在参数数目、类型上的不同（如铁饶的**续命大法**就是通过这个判断的，即静态多态）
* 运行这个成员函数的对象是谁（动态多态）

## Q2：Overwrite与Overload

* **Overwrite：**屏蔽父类关键字实现的函数方法重写，取决于引用类型
* **Overload：**  将语义、功能相似的几个函数用同一个名字表示，但参数或返回值不同（包括类型、顺序不同），即函数重载
* **Override：** 覆盖，重新定义，基类必须要有virtual关键字，运行时取决于作用范围

### e.g

#### Overwrite

**朱铁饶**　生了一个儿子叫　**朱王**；他从父亲那里继承了　**续命大法 **；

但是他发现，在遇到　**一条狗**　的时候，没有必要逃跑，也可以打；

于是他总结了一下：

**朱王**　有一套　**续命大法**　可以用来对付　**一条狗**　{打；}

然而朱王发现，他忘了父亲在遇到坏人时会怎么做. 

##### 小结

Overwrite就是重写覆盖；通过重新定义函数，屏蔽父类关键词（这就是为什么朱王忘了怎么对待坏人的原因），把父类函数藏起来，自立门户.

#### Overload

**朱铁饶**　生了一个女儿叫　**朱翠花**；她从父亲那里继承了**续命大法**.

朱翠花在十岁时在动物园遇到了老虎，发现在老虎面前　**跑**　是一个很不错的选择，所以她把这一条也纳入了父亲的　**续命大法** .

吸取了哥哥**朱王**的教训，**朱翠花**决定先再学习一次父亲的**续命大法**：

**朱翠花**　有一套　**续命大法**　可以用来对付　**一个坏人**　{打；}

**朱翠花**　有一套　**续命大法**　可以用来对付　**两个坏人**　{跑；}

**朱翠花**　有一套　**续命大法**　可以用来对付　**一条狗**　{跑；}

然后加上了她的最新研究结果：

**朱翠花**　有一套　**续命大法**　可以用来对付　**一只老虎**　{跑；}

朱翠花发现她已经在父亲的基础上有了新的突破！

##### 小结

不同的函数使用相同的函数名，但是函数的参数个数或类型不同。调用的时候根据函数的参数来区别不同的函数；你会发现Q1本质上也是Overload；

在Overload新成员函数时时，如需保留父类函数，则要先将父类函数先Overwrite一次；所以，Overload必定伴随着Override。

### 总结

* Overwrite时采用的是“屏蔽关键字”的做法
* 在直接Overload时计算机会尝试Overwrite进而屏蔽关键词，Overload达不到目的；所以需要先进行对原来函数的Overwrite(内容一样)；

## Q3：虚函数

* **虚函数 virtual** ： 虚函数，派生类需要重新实现，编译器将实现动态绑定。

### 重新定义？

罗老师：重新定义xxx

只是单纯的重新定义，原来的定义还在，锤子大部分员工在老罗面前表示认同，但私底下并不傻

**作用域**

### Overwrite的局限性

如果有一个父类指针类型的变量，指向子类，那么运行被子类Overwrite的函数时，调用的是父类实现的该函数；

但是怎么调用子类实现的该函数？

### Virtual实现Override

接上一个问题，通过在父类函数前添加关键词**Virtual**，可以在父类指针指向子类时根据指向的对象类型调用函数的实现，解决了如上问题.

### 纯虚函数

上述情形中我们可以发现，父类的虚函数，子类可以选择不再重新实现；

为了避免不必要的误会，我们引入纯虚函数；通过在函数参数表后面添加**=0**关键字，强迫子类重新实现该函数;

**e.g** 　南方某大学在审批实验经费时向某贺姓教授强调：出去了别把师傅供出来。关于对这段记忆的描述，南方某大学封装在了一个纯虚函数里；为了保护支持来源，贺姓教授每次在讲起经费时都会重定义一次，说南方某大学不知情。

### 抽象类

耶稣.











